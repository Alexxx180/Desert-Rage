<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:status="clr-namespace:DesertRage.Controls.Status"
                    xmlns:attach="clr-namespace:DesertRage.Decorators.UI.Bindings.Attach;assembly=DesertRageDecorators"
                    xmlns:target="clr-namespace:DesertRage.Model.Locations.Battle;assembly=DesertRageModel"
                    xmlns:total="clr-namespace:DesertRage.Resources.Media.Images.Locations.Total"
                    xmlns:converters="clr-namespace:DesertRage.Decorators.UI.Bindings.Converters;assembly=DesertRageDecorators"
                    xmlns:svgc="clr-namespace:SharpVectors.Converters;assembly=SharpVectors.Converters.Wpf">
    <ControlTemplate x:Key="HpBar">
        <Grid DataContext="{Binding}">
            <status:StatBar>
                <status:StatBar.Caption>
                    ОЗ
                </status:StatBar.Caption>

                <status:StatBar.Bar>
                    <Binding Path="Hp"/>
                </status:StatBar.Bar>

                <status:StatBar.ForeBrush>
                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                        <GradientStop Color="#FF3AAC28"/>
                        <GradientStop Color="#FF00F3FF" Offset="1"/>
                        <GradientStop Color="#FF0EDEAF" Offset="0.512"/>
                    </LinearGradientBrush>
                </status:StatBar.ForeBrush>
            </status:StatBar>
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="ApBar">
        <Grid DataContext="{Binding}">
            <status:StatBar>
                <status:StatBar.Caption>
                    ОД
                </status:StatBar.Caption>

                <status:StatBar.Bar>
                    <Binding Path="Ap"/>
                </status:StatBar.Bar>

                <status:StatBar.ForeBrush>
                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                        <GradientStop Color="#FFFFEDED"/>
                        <GradientStop Color="#FF00EDED" Offset="1"/>
                        <GradientStop Color="#FF00ADED" Offset="0.512"/>
                    </LinearGradientBrush>
                </status:StatBar.ForeBrush>
            </status:StatBar>
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </Grid>
    </ControlTemplate>
    
    <ControlTemplate x:Key="TimeBar">
        <Grid DataContext="{Binding}">
            <status:StatBar>
                <status:StatBar.Caption>
                    Время
                </status:StatBar.Caption>

                <status:StatBar.Bar>
                    <Binding Path="Time"/>
                </status:StatBar.Bar>

                <status:StatBar.ForeBrush>
                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                        <GradientStop Color="#FFBB835C"/>
                        <GradientStop Color="#FFC7FF1D" Offset="0.512"/>
                        <GradientStop Color="#FFC7631D" Offset="1"/>
                    </LinearGradientBrush>
                </status:StatBar.ForeBrush>
            </status:StatBar>
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="StatsVertical">
        <UniformGrid Rows="4" Columns="1" DataContext="{Binding}">
            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Attack.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Attack"/>
                </status:IconStat.Stat>
            </status:IconStat>

            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Defence.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Defence"/>
                </status:IconStat.Stat>
            </status:IconStat>

            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Speed.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Speed"/>
                </status:IconStat.Stat>
            </status:IconStat>

            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Special.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Special"/>
                </status:IconStat.Stat>
            </status:IconStat>
        </UniformGrid>
    </ControlTemplate>

    <ControlTemplate x:Key="StatsHorizontal">
        <UniformGrid Rows="1" Columns="4" DataContext="{Binding}">
            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Attack.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Attack"/>
                </status:IconStat.Stat>
            </status:IconStat>

            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Defence.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Defence"/>
                </status:IconStat.Stat>
            </status:IconStat>

            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Speed.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Speed"/>
                </status:IconStat.Stat>
            </status:IconStat>

            <status:IconStat>
                <status:IconStat.Icon>
                    /Resources/Media/Images/Menu/Stats/Special.svg
                </status:IconStat.Icon>

                <status:IconStat.Stat>
                    <Binding Path="Special"/>
                </status:IconStat.Stat>
            </status:IconStat>
        </UniformGrid>
    </ControlTemplate>

    <ControlTemplate x:Key="ExperienceBar">
        <Grid DataContext="{Binding}">
            <ProgressBar>
                <Grid.Column>
                    1
                </Grid.Column>

                <ProgressBar.Value>
                    <Binding Path="Experience.Current"/>
                </ProgressBar.Value>

                <ProgressBar.Maximum>
                    <Binding Path="Experience.Max"/>
                </ProgressBar.Maximum>

                <ProgressBar.Orientation>
                    Vertical
                </ProgressBar.Orientation>

                <ProgressBar.Foreground>
                    <LinearGradientBrush EndPoint="0.75,0.5" StartPoint="0,0.75">
                        <GradientStop Color="#FFEDEDED"/>
                        <GradientStop Color="#FFED00ED" Offset="1"/>
                        <GradientStop Color="#FFAD00ED" Offset="0.512"/>
                    </LinearGradientBrush>
                </ProgressBar.Foreground>
            </ProgressBar>
            
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="Statuses">
        <ItemsControl ItemsSource="{Binding Path=StatusInfo}">
            <Grid.Row>
                1
            </Grid.Row>

            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="12" Rows="1">
                        <UniformGrid.VerticalAlignment>
                            Stretch
                        </UniformGrid.VerticalAlignment>

                        <UniformGrid.IsItemsHost>
                            True
                        </UniformGrid.IsItemsHost>
                    </UniformGrid>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>

            <ItemsControl.ItemTemplate>
                <StaticResource ResourceKey="StatusTemplate"/>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </ControlTemplate>

    <ControlTemplate x:Key="StatusPanel">
        <Grid DataContext="{Binding}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.125*"/>
                <ColumnDefinition Width="0.875*"/>
            </Grid.ColumnDefinitions>

            <svgc:SvgViewbox>
                <DockPanel.Dock>
                    Left
                </DockPanel.Dock>

                <attach:SvgBox.Source>
                    <Binding Path="Icon">
                        <Binding.Converter>
                            <converters:UriConverter/>
                        </Binding.Converter>

                        <Binding.ConverterParameter>
                            <x:Static Member="total:LocationsTotal.Transparent"/>
                        </Binding.ConverterParameter>
                    </Binding>
                </attach:SvgBox.Source>

                <attach:SvgBox.Stretch>
                    Fill
                </attach:SvgBox.Stretch>
            </svgc:SvgViewbox>

            <UniformGrid Rows="3" Grid.Column="1">
                <ContentControl Template="{StaticResource HpBar}"/>
                <ContentControl Template="{StaticResource ApBar}"/>
                <ContentControl Template="{StaticResource Statuses}"/>
            </UniformGrid>

            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="Person" x:Shared="True">
        <Grid x:Name="BattleCharacter" DataContext="{Binding}">
            <Grid.Column>
                1
            </Grid.Column>

            <Grid.RowDefinitions>
                <RowDefinition Height="0.2*"/>
                <RowDefinition Height="0.6*"/>
                <RowDefinition Height="0.2*"/>
            </Grid.RowDefinitions>

            <Grid>
                <Grid.Style>
                    <StaticResource ResourceKey="BackAccent"/>
                </Grid.Style>

                <Grid.RowDefinitions>
                    <RowDefinition Height="0.75"/>
                    <RowDefinition Height="0.25"/>
                </Grid.RowDefinitions>

                <ContentControl Template="{StaticResource StatusPanel}">
                    <ContentControl.DataContext>
                        <Binding Path="Player.Hero"/>
                    </ContentControl.DataContext>
                </ContentControl>

                <ContentControl Template="{StaticResource TimeBar}">
                    <Grid.Row>
                        1
                    </Grid.Row>
                </ContentControl>
            </Grid>

            <svgc:SvgViewbox>
                <Grid.Row>
                    1
                </Grid.Row>

                <attach:SvgBox.Source>
                    <Binding Path="Player.Hero.Image"/>
                </attach:SvgBox.Source>

                <attach:SvgBox.Stretch>
                    Fill
                </attach:SvgBox.Stretch>

                <svgc:SvgViewbox.Style>
                    <Style>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=IsAct}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard AutoReverse="True">
                                            <DoubleAnimation>
                                                <DoubleAnimation.From>
                                                    1.0
                                                </DoubleAnimation.From>

                                                <DoubleAnimation.To>
                                                    0.0
                                                </DoubleAnimation.To>

                                                <DoubleAnimation.Duration>
                                                    0:0:0.2
                                                </DoubleAnimation.Duration>

                                                <Storyboard.TargetProperty>
                                                    Opacity
                                                </Storyboard.TargetProperty>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </svgc:SvgViewbox.Style>
            </svgc:SvgViewbox>

            <svgc:SvgViewbox Opacity="0">
                <Grid.Row>
                    1
                </Grid.Row>

                <attach:SvgBox.Source>
                    <Binding Path="Unit.Action"/>
                </attach:SvgBox.Source>

                <attach:SvgBox.Stretch>
                    Fill
                </attach:SvgBox.Stretch>

                <svgc:SvgViewbox.Style>
                    <Style>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=IsAct}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard AutoReverse="True">
                                            <DoubleAnimation>
                                                <DoubleAnimation.From>
                                                    0.0
                                                </DoubleAnimation.From>

                                                <DoubleAnimation.To>
                                                    1.0
                                                </DoubleAnimation.To>

                                                <DoubleAnimation.Duration>
                                                    0:0:0.2
                                                </DoubleAnimation.Duration>

                                                <Storyboard.TargetProperty>
                                                    Opacity
                                                </Storyboard.TargetProperty>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </svgc:SvgViewbox.Style>
            </svgc:SvgViewbox>

            <Menu x:Name="MOptions">
                <Grid.Row>
                    2
                </Grid.Row>

                <Menu.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="3" Rows="3"/>
                    </ItemsPanelTemplate>
                </Menu.ItemsPanel>

                <MenuItem>
                    <MenuItem.VerticalAlignment>
                        Center
                    </MenuItem.VerticalAlignment>

                    <MenuItem.Style>
                        <StaticResource ResourceKey="WhiteOption"/>
                    </MenuItem.Style>

                    <MenuItem.ToolTip>
                        <TextBlock>
                            <Run FontWeight="Bold">Бой</Run>
                            <LineBreak/>
                            <Run Text="Использовать оружие по назначению"/>
                        </TextBlock>
                    </MenuItem.ToolTip>

                    <MenuItem.Header>
                        <TextBlock>
                            <TextBlock.VerticalAlignment>
                                Center
                            </TextBlock.VerticalAlignment>
                                Бой
                        </TextBlock>
                    </MenuItem.Header>

                    <MenuItem.Icon>
                        <svgc:SvgViewbox>
                            <attach:SvgBox.Source>
                                /Resources/Media/Images/menu/stats/Attack.svg
                            </attach:SvgBox.Source>

                            <attach:SvgBox.Stretch>
                                Uniform
                            </attach:SvgBox.Stretch>
                        </svgc:SvgViewbox>
                    </MenuItem.Icon>

                    <MenuItem.ItemTemplate>
                        <StaticResource ResourceKey="TargetTemplate"/>
                    </MenuItem.ItemTemplate>

                    <MenuItem.ItemsSource>
                        <Binding Path="ViewModel.Enemies"/>
                    </MenuItem.ItemsSource>

                    <MenuItem.ItemContainerStyle>
                        <Style TargetType="MenuItem" BasedOn="{StaticResource Impact}">
                            <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=MenuItem}, Path=DataContext.Fight}"/>
                            <Setter Property="CommandParameter" Value="{Binding RelativeSource={RelativeSource Self}, Path=DataContext}"/>
                        </Style>
                    </MenuItem.ItemContainerStyle>
                </MenuItem>

                <MenuItem>
                    <MenuItem.VerticalContentAlignment>
                        Center
                    </MenuItem.VerticalContentAlignment>

                    <MenuItem.Style>
                        <StaticResource ResourceKey="WhiteOption"/>
                    </MenuItem.Style>

                    <MenuItem.ToolTip>
                        <TextBlock>
                            <Run FontWeight="Bold">Прием</Run>
                            <LineBreak/>
                            <Run Text="Применить умения на практике"/>
                        </TextBlock>
                    </MenuItem.ToolTip>

                    <MenuItem.Header>
                        <TextBlock>
                            <TextBlock.VerticalAlignment>
                                Center
                            </TextBlock.VerticalAlignment>
                                Прием
                        </TextBlock>
                    </MenuItem.Header>

                    <MenuItem.Icon>
                        <svgc:SvgViewbox>
                            <Grid.Row>
                                1
                            </Grid.Row>

                            <attach:SvgBox.Source>
                                /Resources/Media/Images/menu/stats/Special.svg
                            </attach:SvgBox.Source>

                            <attach:SvgBox.Stretch>
                                Uniform
                            </attach:SvgBox.Stretch>
                        </svgc:SvgViewbox>
                    </MenuItem.Icon>

                    <MenuItem.ItemTemplate>
                        <StaticResource ResourceKey="SkillTemplate"/>
                    </MenuItem.ItemTemplate>

                    <MenuItem.ItemsSource>
                        <Binding Path="Player.Skills"/>
                    </MenuItem.ItemsSource>

                    <MenuItem.ItemContainerStyle>
                        <StaticResource ResourceKey="PlayerSkills"/>
                    </MenuItem.ItemContainerStyle>
                </MenuItem>

                <MenuItem>
                    <MenuItem.VerticalContentAlignment>
                        Center
                    </MenuItem.VerticalContentAlignment>

                    <MenuItem.Style>
                        <StaticResource ResourceKey="WhiteOption"/>
                    </MenuItem.Style>

                    <MenuItem.ToolTip>
                        <TextBlock>
                            <Run FontWeight="Bold">Сумка</Run>
                            <LineBreak/>
                            <Run Text="Использовать предметы"/>
                        </TextBlock>
                    </MenuItem.ToolTip>

                    <MenuItem.Header>
                        <TextBlock>
                            <TextBlock.VerticalAlignment>
                                Center
                            </TextBlock.VerticalAlignment>

                            <TextBlock.Text>
                                Сумка
                            </TextBlock.Text>
                        </TextBlock>
                    </MenuItem.Header>

                    <MenuItem.Icon>
                        <svgc:SvgViewbox>
                            <Grid.Row>
                                1
                            </Grid.Row>

                            <attach:SvgBox.Source>
                                /Resources/Media/Images/Menu/Topics/Items.svg
                            </attach:SvgBox.Source>

                            <attach:SvgBox.Stretch>
                                Uniform
                            </attach:SvgBox.Stretch>
                        </svgc:SvgViewbox>
                    </MenuItem.Icon>

                    <MenuItem.HorizontalContentAlignment>
                        Stretch
                    </MenuItem.HorizontalContentAlignment>

                    <MenuItem.ItemTemplate>
                        <StaticResource ResourceKey="ItemTemplate"/>
                    </MenuItem.ItemTemplate>

                    <MenuItem.ItemsSource>
                        <Binding Path="Player.Items"/>
                    </MenuItem.ItemsSource>

                    <MenuItem.ItemContainerStyle>
                        <StaticResource ResourceKey="PlayerItems"/>
                    </MenuItem.ItemContainerStyle>
                </MenuItem>

                <MenuItem Command="{Binding Shield}">
                    <MenuItem.VerticalContentAlignment>
                        Center
                    </MenuItem.VerticalContentAlignment>

                    <MenuItem.Style>
                        <StaticResource ResourceKey="WhiteOption"/>
                    </MenuItem.Style>

                    <MenuItem.ToolTip>
                        <TextBlock>
                        <Run FontWeight="Bold">Щит</Run>
                        <LineBreak/>
                        <Run Text="Принять оборонительную позицию"/>
                        </TextBlock>
                    </MenuItem.ToolTip>

                    <MenuItem.Header>
                        <TextBlock>
                            <TextBlock.VerticalAlignment>
                                Center
                            </TextBlock.VerticalAlignment>

                            <TextBlock.Text>
                                Щит
                            </TextBlock.Text>
                        </TextBlock>
                    </MenuItem.Header>

                    <MenuItem.Icon>
                        <svgc:SvgViewbox>
                            <Grid.Row>
                                1
                            </Grid.Row>

                            <attach:SvgBox.Source>
                                /Resources/Media/Images/menu/stats/Defence.svg
                            </attach:SvgBox.Source>

                            <attach:SvgBox.Stretch>
                                Uniform
                            </attach:SvgBox.Stretch>
                        </svgc:SvgViewbox>
                    </MenuItem.Icon>
                </MenuItem>

                <MenuItem Command="{Binding Flee}">
                    <MenuItem.VerticalContentAlignment>
                        Center
                    </MenuItem.VerticalContentAlignment>

                    <MenuItem.Style>
                        <StaticResource ResourceKey="WhiteOption"/>
                    </MenuItem.Style>

                    <MenuItem.Header>
                        <TextBlock>
                            <TextBlock.VerticalAlignment>
                                Center
                            </TextBlock.VerticalAlignment>

                            <TextBlock.Text>
                                Побег
                            </TextBlock.Text>
                        </TextBlock>
                    </MenuItem.Header>

                    <MenuItem.ToolTip>
                        <TextBlock>
                        <Run FontWeight="Bold">Побег</Run>
                        <LineBreak/>
                        <Run Text="Сбежать..."/>
                        </TextBlock>
                    </MenuItem.ToolTip>

                    <MenuItem.Icon>
                        <svgc:SvgViewbox>
                            <Grid.Row>
                                1
                            </Grid.Row>

                            <attach:SvgBox.Source>
                                /Resources/Media/Images/menu/stats/Speed.svg
                            </attach:SvgBox.Source>

                            <attach:SvgBox.Stretch>
                                Uniform
                            </attach:SvgBox.Stretch>
                        </svgc:SvgViewbox>
                    </MenuItem.Icon>
                </MenuItem>

                <MenuItem Command="{Binding Auto}">
                    <MenuItem.VerticalContentAlignment>
                        Center
                    </MenuItem.VerticalContentAlignment>

                    <MenuItem.Style>
                        <StaticResource ResourceKey="WhiteOption"/>
                    </MenuItem.Style>

                    <MenuItem.ToolTip>
                        <TextBlock>
                        <Run FontWeight="Bold">Бойня</Run>
                        <LineBreak/>
                        <Run Text="Горячо поприветствовать оппонентов"/>
                        </TextBlock>
                    </MenuItem.ToolTip>

                    <MenuItem.Header>
                        <TextBlock>
                            <TextBlock.VerticalAlignment>
                                Center
                            </TextBlock.VerticalAlignment>

                            <TextBlock.Text>
                                Бойня
                            </TextBlock.Text>
                        </TextBlock>
                    </MenuItem.Header>

                    <MenuItem.Icon>
                        <svgc:SvgViewbox>
                            <attach:SvgBox.Source>
                                /Resources/Media/Images/Battle/Character/Ray/Icon.svg
                            </attach:SvgBox.Source>

                            <attach:SvgBox.Stretch>
                                Uniform
                            </attach:SvgBox.Stretch>
                        </svgc:SvgViewbox>
                    </MenuItem.Icon>
                </MenuItem>

                <Menu.Style>
                    <StaticResource ResourceKey="BackAccent"/>
                </Menu.Style>
            </Menu>

            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
        </Grid>
    </ControlTemplate>
</ResourceDictionary>